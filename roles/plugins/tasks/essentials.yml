---

- name: Ensure EssentialsX configuration directory exists
  file:
    path: /home/minecraft/purpur/plugins/Essentials
    state: directory
    owner: minecraft
    group: minecraft
    mode: '0755'

- name: Download EssentialsX plugin
  get_url:
    url: https://ci.ender.zone/job/EssentialsX/lastSuccessfulBuild/artifact/jars/EssentialsX-2.21.0-dev+81-cde7184.jar
    dest: /home/minecraft/purpur/plugins/EssentialsX.jar
    owner: minecraft
    mode: '0755'

- name: Download EssentialsX Chat plugin (optional, but recommended for chat management)
  get_url:
    url: https://ci.ender.zone/job/EssentialsX/lastSuccessfulBuild/artifact/jars/EssentialsXChat-2.21.0-dev+81-cde7184.jar
    dest: /home/minecraft/purpur/plugins/EssentialsXChat.jar
    owner: minecraft

- name: Configure EssentialsX welcome message
  copy:
    dest: /home/minecraft/purpur/plugins/Essentials/config.yml
    content: |
      settings:
        # Custom join messages
        login-message: "&eWelcome {PLAYER} to the server! Have a great time!"
        # Custom quit messages
        logout-message: "&e{PLAYER} has left the server. See you next time!"
    owner: minecraft
    group: minecraft
    mode: '0644'
